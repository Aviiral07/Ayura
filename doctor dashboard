<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doctor Dashboard | EMR Access & FHIR Services</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* New style for the doctor's action buttons/grid */
        .doctor-actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .action-card {
            background: #fff;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            text-align: center;
            transition: transform 0.2s;
            text-decoration: none;
            color: #2c3e50;
            font-weight: 600;
        }
        .action-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }
        .action-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #2980b9; /* Blue for doctor tools */
        }

        /* Styles for the EMR Consent Box (reusing previous logic) */
        .emr-access-box {
            background: #ecf0f1;
            padding: 30px;
            border-radius: 10px;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .status-indicator {
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
            margin-top: 20px;
        }
        .status-waiting { background: #f1c40f; color: #34495e; }
        .status-granted { background: #2ecc71; color: white; }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="container header-content">
            <h1 class="logo">AYURA Doctor Hub</h1>
            <nav>
                <ul>
                    <li><a href="emr_view.html" class="active">Dashboard</a></li>
                    <li><a href="demo.html">API Demo</a></li>
                    <li><a href="tech_docs.html">FHIR Docs</a></li>
                    <li><a href="login.html">Logout</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="page-main">
        <div class="container">
            <div class="dashboard-header">
                <h2>Welcome, Dr. [Verified Name]</h2>
                <p>Access patient EMRs securely and utilize the FHIR Terminology Microservice.</p>
            </div>

            <div class="doctor-actions-grid">
                
                <a href="#emr-form-section" class="action-card" onclick="document.getElementById('emr-form-section').scrollIntoView({behavior: 'smooth'});">
                    <div class="action-icon">üîí</div>
                    Retrieve Patient EMR (ABHA)
                </a>
                
                <a href="demo.html" class="action-card">
                    <div class="action-icon">‚Üî</div>
                    NAMASTE/ICD-11 Translation Demo
                </a>

                <a href="tech_docs.html" class="action-card">
                    <div class="action-icon">‚öô</div>
                    View FHIR API Endpoints
                </a>
            </div>

            <div class="emr-access-box">
                <h3 id="emr-form-section" style="margin-top: 0;">1. Request Patient Consent & EMR Data</h3>
                
                <form id="emrAccessForm">
                    <div class="form-group">
                        <label for="abhaId">Patient ABHA ID *</label>
                        <input type="text" id="abhaId" required placeholder="Enter 14-digit ABHA ID (e.g., 1234-5678-9012-34)">
                    </div>

                    <div class="form-group">
                        <label for="purpose">Purpose of Access *</label>
                        <select id="purpose" required>
                            <option value="">-- Select Purpose --</option>
                            <option value="TREATMENT">Treatment / Consultation</option>
                            <option value="RESEARCH">Research / Study (Anonymized)</option>
                            <option value="AUDIT">Audit / Compliance Check</option>
                        </select>
                    </div>

                    <button type="submit" class="hero-btn verify-btn" id="requestConsentBtn">
                        Request Consent via ABHA App
                    </button>
                </form>

                <div class="status-indicator status-waiting" id="consentStatus" style="display: none;">
                    ‚è≥ Waiting for Patient Approval...
                </div>
            </div>

            <div id="emrDataView" style="display: none; margin-top: 40px;">
                <h3 style="color: #2ecc71;">2. Patient Health Record (Consent Granted)</h3>
                
                <div class="emr-data-card">
                    <h4>Patient Details</h4>
                    <p><strong>Name:</strong> Ms. Aarti Sharma</p>
                    <p><strong>DOB:</strong> 15/05/1990</p>
                    <p><strong>ABHA ID:</strong> 1234-5678-9012-34</p>
                </div>

                <div class="emr-data-card">
                    <h4>Problem List (Standardized Data)</h4>
                    
                    <p><strong>Condition: Aamvata (Rheumatoid Arthritis)</strong></p>
                    <ul>
                        <li>*AYUSH Code (NAMASTE):* D-0010</li>
                        <li>*Global Code (ICD-11 TM2):* 2A73.0 (Rheumatoid arthritis, classic onset)</li>
                        <li>*Date Diagnosed:* 2022-10-01</li>
                    </ul>
                    
                    <hr>
                    
                    <p><strong>Condition: Kasa (Cough)</strong></p>
                    <ul>
                        <li>*AYUSH Code (NAMASTE):* J-0050</li>
                        <li>*Global Code (ICD-11 TM2):* MF21.1 (Cough)</li>
                        <li>*Date Diagnosed:* 2024-05-15</li>
                    </ul>
                </div>
            </div>
        </div>
    </main>

    <footer class="main-footer">
        <div class="container">
            <p>&copy; 2024 AYURA. A Dual-Role Platform.</p>
            <div class="footer-links">
                <a href="privacy.html">Privacy</a> | 
                <a href="terms.html">Terms</a>
            </div>
        </div>
    </footer>

    <script>
        document.getElementById('emrAccessForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const consentStatus = document.getElementById('consentStatus');
            const emrDataView = document.getElementById('emrDataView');
            const consentBtn = document.getElementById('requestConsentBtn');

            // 1. Show Waiting Status
            emrDataView.style.display = 'none';
            consentStatus.style.display = 'block';
            consentStatus.className = 'status-indicator status-waiting';
            consentStatus.innerHTML = '‚è≥ Waiting for Patient Approval via ABHA App...';
            consentBtn.disabled = true;

            // 2. Simulate Delay for Patient Interaction (e.g., 3 seconds)
            setTimeout(() => {
                // 3. Simulate Consent Granted
                consentStatus.className = 'status-indicator status-granted';
                consentStatus.innerHTML = '‚úÖ Consent Granted! Retrieving Data...';
                
                // 4. Display EMR Data after a slight delay
                setTimeout(() => {
                    emrDataView.style.display = 'block';
                    consentBtn.disabled = false; // Allow new requests
                    consentBtn.innerHTML = 'Request New Consent';
                }, 1000);

            }, 3000);
        });
    </script>
</body>
</html>
